import { registerHandlers, run, type Handler } from "encore.dev/internal/codegen/appinit";
{{#each endpoints}}
import { {{name}} as {{name}}Impl{{@index}} } from {{toJSON import_path}};
{{/each}}
{{#each subscriptions}}
import {{toJSON import_path}};
{{/each}}
{{#with service}}
import * as {{encoreNameToIdent name}}_service from {{toJSON import_path}};
{{/with}}

const handlers: Handler[] = [
{{#each endpoints}}
    {
        apiRoute: {
            service:           {{toJSON ../name}},
            name:              {{toJSON name}},
            handler:           {{name}}Impl{{@index}},
            raw:               {{toJSON raw}},
            streamingRequest:  {{toJSON streaming_request}},
            streamingResponse: {{toJSON streaming_response}},
        },
        middlewares: {{#with ../service}}{{encoreNameToIdent name}}_service.default.cfg.middlewares || {{/with}}[],

    },
{{/each}}
];

registerHandlers(handlers);
await run();
